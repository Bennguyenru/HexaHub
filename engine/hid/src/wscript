#! /usr/bin/env python
import os
from waf_dynamo import dmsdk_add_files
from BuildUtility import create_build_utility

def options(opt):
    pass

def build(bld):
    build_util = create_build_utility(bld.env)

    platform_folder = 'glfw'
    if build_util.get_target_os() in ('nx64',):
        platform_folder = build_util.get_target_os()

    hid = bld.stlib(features = 'cxx cstaticlib',
                    includes = [platform_folder,'.'],
                    target   = 'hid',
                    install_path = build_util.get_library_path(),
                    source   = bld.path.ant_glob(['hid.cpp', '%s/hid_native.cpp' % platform_folder]))

    hid_null = bld.stlib(features = 'cxx cstaticlib',
                         includes = [platform_folder, '.', 'null'],
                         proto_gen_py = True,
                         target = 'hid_null',
                         install_path = build_util.get_library_path(),
                         source = bld.path.ant_glob(['hid.cpp', 'hid_null.cpp']))

    bld.add_group()
    bld.recurse('test')

    bld.install_files('${PREFIX}/include/hid', 'hid.h')

    dmsdk_add_files(bld, '${PREFIX}/sdk/include/dmsdk', 'dmsdk')

def configure(conf):
    pass

